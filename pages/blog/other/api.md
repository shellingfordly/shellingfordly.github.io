---
title: 关于API的相关知识点
date: 2024-4-7 14:58:45
tags:
  - API
  - REST API
  - GraphQL
---

# 了解 API

[原文](https://www.redhat.com/zh/topics/api#%E6%9C%89%E4%BD%95%E5%8A%9F%E7%94%A8)

想在网页端和移动端拓展业务，很大程度上都要取决于沟通和集成的能力，以及如何将您的产品和服务与不同软件程序连接起来。应用编程接口（API）就是实现上述目标的关键所在，能助您最大限度地改进灵活性、简易性、安全性和控制力。

## 什么是 API

应用编程接口（API）由一组用于集成应用软件和服务的工具、定义和协议组合而成。有了这类接口，您无需不断构建新的连接基础架构，就能让自己的产品和服务与其他产品和服务进行通信。

API 既可以私有（仅供内部使用），也可以合用（与特定合作伙伴共享以创造更多收益）或公用（允许第三方开发的应用能与您的 API 交互，从而推动创新）。共享 API 能为您带来诸多益处，包括：

- 创造新的收入渠道，或拓展现有渠道。
- 扩大您的品牌覆盖范围。
- 通过外部开发和协作，推动开放创新或提高效率。

## 什么是 RESTful API 和 SOAP？

简单对象访问协议（SOAP）和表述性状态传递（[REST](#什么是-rest-api)）是两种有助于简化 API 设计并优化实施结果的措施。随着 Web API 的不断普及，业界制定了 SOAP 来帮助标准化消息格式和请求。通过这种协议规范，能让不同环境中或以不同语言编写的应用更加轻松地相互通信。而 REST 则是一种架构模式。REST 依赖于比规定协议更易遵循的 6 大指导原则。因此，RESTful API 现在比 SOAP 更为普及。

## API 有何用处？

API 堪称是为集成而生，即把 IT 组织中的各种数据、应用和设备全都联动起来，使您所采用的各项技术能够更好地相互通信并协同工作。如果您的技术无法互通或连接其他人的技术，就是时间和资金的双重浪费。API、分布式集成和容器是实现敏捷集成的关键所在。

敏捷集成是一种强调简化 IT 空间占用、面向集成平台的架构方案；具备高度可扩展性和可用性；定义明确、可以复用且易于管理的端点。我们坚信，未来的互联系统不仅能支撑团队和技术之间的相互协作，更能起到促进作用。面对日益频繁的技术变革，我们相信，敏捷集成是帮助您实现业务转型的最佳良方。

## 什么是 API 管理？

许多企业都实施了各种 API 管理策略，力争及时响应快速变化的客户需求。基于 HTTP 的 API 已成为微服务架构之间同步交互的首选方法。这些 API 是将所有微服务连接在一起的粘合剂。

管理好这些 API，企业就能确保 API 的使用符合公司策略，并根据实际情况，以相应的安全级别进行监管（某些服务可能需要不同的安全策略）。

[了解更多->](#什么是-api-管理？-1)

## 什么是 API 安全防护？

您应该不会把自己的钱存放在床垫之下。大多数人都会把钱存到可信的环境（银行）中，并采用独立的方式授权和验证支付。API 安全防护与之相似。您需要一个具有验证和授权策略的可信环境。

API 安全防护的最佳实践包括使用令牌、加密和签名、配额和限流，以及 API 网关。但最重要的是，API 安全离不开良好的 API 管理。

[了解更多->](#api-安全防护)

## 什么是 API 货币化？

API 被广泛认为是下一代业务开发的基石。API 是 Web 站点的核心，可以允许其他人访问您的数据和资源，并将其集成到公共或私有站点和应用中。

在理想情况下，在您实施 API 管理计划时，应该拥有完善的业务模式，可以为您的货币化目标提供框架。API 货币化不仅仅是指通过 API 创造收入，还涉及如何保持 API 的正常运行，让消费者获益。

[了解更多->](#什么是-api-货币化？-1)

## 什么是 API 设计？

API 正在成为数字化连接现代组织的一种方式，为其增添各种新的功能，覆盖从运营和产品到合作伙伴战略等方方面面。大多数企业的疑问已不再是该不该开发 API 程序，而是想要知道具体该怎么做。

您是否准备在您的组织实施 API 程序？在准备设计 API 程序时，有三个问题要问。

[了解更多->](#什么是-api-设计？-1)

## 什么是 API 网关？

API 网关是一个位于客户端与后端服务集之间的 API 管理工具。

API 网关将充当反向代理，用于接受所有应用编程接口（API）调用、整合处理这些调用所需的各种服务，并返回相应的结果。

[了解更多->](#什么是-API-网关？-1)

## 什么是 GraphQL？

GraphQL 是一种用于 API 的查询语言和服务器端运行时，它可以使客户端准确地获得所需的数据，没有任何冗余。GraphQL 旨在让 API 变得快速、灵活并且为开发人员提供便利。作为 REST 的替代方案，GraphQL 允许开发人员构建相应的请求，从而通过单个 API 调用从多个数据源中提取数据。

[了解更多->](#什么是-graphql)

---

# 什么是 API 管理？

[原文](https://www.redhat.com/zh/topics/api/what-is-api-management)

API 是跨企业和云连接应用和数据的工具，而 API 管理就是指分发、控制、分析的这些 API 的过程。API 管理的目标，是让创建 API 或使用他人 API 的机构能够监控其 API 活动，确保满足使用 API 的开发人员和应用的需求。

许多企业都实施了各种 API 管理策略，力争及时响应快速变化的客户需求。在大多数情况下，企业会采用微服务架构，想要通过加速软件开发来满足需求。基于 HTTP 的 API 已成为微服务架构之间同步交互的首选方法。这些 API 是将所有微服务连接在一起的粘合剂。管理好这些 API，企业就能确保 API 的使用符合公司策略，并根据实际情况，以相应的安全级别进行监管（某些服务可能需要不同的安全策略）。

## API 管理和微服务

微服务和 API 是云原生应用开发的基础，这种方法旨在通过快速开发创新应用组件来满足新的业务需求。但这种方法并不是完全之策。

将较大的系统拆分为小的组件，是创造微服务的关键技术挑战。正如我们所说，API 可让这些较小的组件相互连接并与数据源连接。

而如何协调许多频繁变化的微服务，是微服务架构带来的另一个挑战。借助服务发现，这一过程就变得简单许多。API 管理可提供必要的发现机制，确保找到可用的微服务，并通过开发人员门户共享有关如何使用这些微服务的文档。

微服务需要一种综合的安全防护方法。安全机制根据 API 的类型而不同：面向外部的服务所需的安全机制与面向内部的服务不同。对于不太关键的 API，使用 API 密钥进行简单保护通常就足够了。而对于外部或关键 API，就需要更安全的方法，如 OAuth。

[阅读 API 安全防护](#api-安全防护)

## 准备为微服务设计 API？

动手前，先考虑以下的重要问题：

- 如何控制对 API 的访问？
- 如何获取指标和处理警报？
- 如何管理使用高峰？
- 谁负责 API 的正常运行时间？
- 我们如何看待不受欢迎的 API 使用情况？

[阅读 API 安全防护](#api-设计)

## 如何衡量 API 管理工作的成功与否？

如果不衡量我们努力的效果，就无法评估我们的管理是否成功。通过分析，我们可以掌握有关 API 活动的数据，但我们仍必须定义到底什么是成功。在您企业内定义成功时，请考虑以下 5 个 API 的关键性能目标：

1. 可靠性

可靠性是指 API 对开发人员是否方便可用。停机时间是衡量可靠性的有用指标。API 是否随时可用？另一个指标是配额，它定义了开发人员在特定时间范围内可以调用多少次 API。配额可以保护 API 不被滥用，使管理更具可预测性。有些 API 提供商都是根据配额来制定业务模式和定价。

2. 灵活性

灵活性是指开发人员在采用 API 时是否拥有多种选项。API 的灵活性更大，则企业管理 API 需要投入的精力（和成本）更多。

3. 质量

质量是指 API 行为是否符合开发人员的期望。这是一种衡量开发人员对 API 满意度的方法。

4. 速度

速度可以通过访问延迟和吞吐量来衡量。限流或缓存等技术都可能会影响速度。

5. 成本

衡量成本的目的是为开发人员提供最具性价比的支持。所有其他 4 个目标都多少有助于实现成本目标。

---

# API 安全防护

[原文](https://www.redhat.com/zh/topics/security/api-security)

API 安全防护就是保护 API（包括您拥有的和您使用的 API）的完整性。但它到底是什么意思？

您或许听过物联网（IoT），它就是通过 API 将计算能力嵌入我们的日常生活中。通过物联网，您的手机可以与家中的冰箱连接，所以当您在回家途中采购食物时，就能清楚知道该买些什么，最终在一小时内就轻松准备好临时聚餐的菜肴。此外，如果您是 DevOps 团队的一员，会利用微服务和容器快速迭代地构建并部署传统和云原生应用。API 就是最常见的微服务和容器通信方式，无论连接系统、连接应用，都要用到 API。随着集成和互联变得愈加重要，API 的重要性也在提升。

## 什么是 Web API 安全防护？REST API 安全防护与 SOAP API 安全防护对比。

Web API 安全防护主要关注通过 API 与互联网的数据传输。OAuth（开放授权）是访问权限委派的开放标准。它让用户不必共享密码就能将 Web 资源的访问权限授予第三方。借助 OAuth 这一技术标准，只需通过一个“分享”按钮，就能将“柯基犬戏水视频集锦”分享到您的社交网络上。

大多数 API 实施属于 REST（表述性状态传递）或 SOAP（简单对象访问协议）。

REST API 使用 HTTP 并且支持传输层安全性（TLS）加密。TLS 是确保互联网连接私密性的一个标准，可以检查两个系统（服务器与服务器或服务器与客户端）之间发送的数据是否受到加密且未被篡改。这意味着，如果黑客试图从购物网站套取您的信用卡信息，他们会无法读取或修改您的数据。如果 URL 的开头是“HTTPS”（超文本传输安全协议），那么该网站就使用了 TLS 保护。

REST API 也使用 JavaScript 对象表示法（JSON），这是一种能够更轻松通过 Web 浏览器传输数据的文件格式。通过使用 HTTP 和 JSON，REST API 不需要存储或重新打包数据，因此速度要比 SOAP API 快得多。

SOAP API 使用称为 Web 服务安全性（WS 安全性）的内置协议。这类协议会定义一套采用保密和身份验证的规则集。SOAP API 支持两大国际标准机构（结构化信息标准促进组织（OASIS）和万维网联盟（W3C）制定的标准，它们结合使用 XML 加密、XML 签名和 SAML 令牌来验证身份和授权。通常而言，SOAP API 因具有更加全面的安全措施而受到推崇，但它们也需要更多的管理。因此，处理敏感数据的机构更推荐采用 SOAP API。

## 有哪些最常见的 API 安全防护最佳实践？

您应该不会把自己的钱存放在床垫之下。大多数人都会把钱存到可信的环境（银行）中，而采用分开的方式授权和验证支付。API 安全防护与之相似。您需要一个具有验证和授权策略的可信环境。

下方列出了一些最常见的加强 API 安全性的方法：

- 使用令牌。建立可信的身份，再通过使用分配给这些身份的令牌来控制对服务和资源的访问。
- 使用加密和签名。通过 TLS 等方式（见上文）加密您的数据。要求使用签名，确保只有拥有权限的用户才能解密和修改您的数据。
- 识别漏洞。确保操作系统、网络、驱动程序和 API 组件保持最新状态。了解如何全面实现协同工作，识别会被用于侵入您的 API 的薄弱之处。使用嗅探器来检测安全问题并跟踪数据泄露。
- 使用配额和限流。对 API 的调用频率设置限额，并跟踪其使用记录。如果 API 调用数量增多，表明它可能正被滥用。也可能是编程出了错，例如在无限循环中调用 API。指定限流规则，防止 API 出现调用激增和拒绝服务攻击。
- 使用 API 网关。API 网关担当主要的 API 流量策略执行点。良好的网关既能帮助您验证流量的使用者身份，也能控制和分析您的 API 使用情况。

## API 管理和安全防护

最后，API 安全性通常取决于良好的 API 管理。许多 API 管理平台支持三种防护方案，它们分别是：

- API 密钥，单一令牌字符串（即提供唯一身份验证信息的小型硬件设备）。
- 基础身份验证（APP ID / APP 密钥），双令牌字符串解决方案（即应户名和密码）。
- OpenID Connect（OIDC），基于主流 OAuth 框架的简单身份层（即通过获取基本配置集信息和使用身份验证服务器来验证用户）。

在选择 API 管理器时，您要清楚它可以处理哪些防护方案，还要制定好计划，明确如何纳入上述 API 安全防护实践。

---

# 什么是 API 货币化？

[原文](https://www.redhat.com/zh/topics/api/what-is-api-monetization)

API 货币化是企业通过其应用程序编程接口（API）创造收入的过程。API 是被广泛视为业务开发的下一个迭代的基石，其中拥有完善的 API 可在数字经济中建立并维护关系。API 是批发版的网络呈现，允许其他人访问您的数据和资源，并将其集成到公共或私有站点和应用中。

希望在您制定 API 管理计划时，您也拥有了一个健康的业务模式，该模式应该为您的货币化目标提供框架。API 货币化不仅仅关乎如何通过 API 创造收入，还涉及如何为消费者保持 API 运行和执行。

并非所有 API 都是在同等条件下创建的，部署 API 的原因也可能各不相同。本文提供了一些常见的 API 货币化模式。

## 消费者支付

在实现免费访问后，下一个可行的 API 货币化方法就是明确消费者在使用 API 提供的服务或资源时所要支付的费用。我们来看看消费者付费使用 API 的 3 种常见方式：

- 分层。一些 API 提供商设置了多层付费访问，例如青铜、黄金或铂金等级。对于 API 资源的访问，每个层都有自己的一组服务和限额，且采用逐步增加每层成本的定价。
- 即用即付。另一种选择是基于实用程序的模型，其中 API 消费者为他们使用的内容付费。根据 API 消耗产生的带宽、存储量和其他硬成本，提供商会根据其成本和逻辑利润收取费用。
- 以单位为基础。最后，其他 API 提供商按单位定义每个 API 资源并分配单价。API 消费者支付他们预期使用的单位数量，并可选择在必要时购买更多

一些 API 提供商混合搭配分层、即用即付和基于单位的 API 定价的不同组合，以恢复运营成本并创造收入。

## 消费者得到报酬

在某些情况下，API 会为公司推动其他收入流，并且实际上可以与 API 消费者分享收入。此方法充当 API 消费者的激励模型，鼓励资源的整合和质量实施，从而为 API 提供商带来收入。共有 3 种不同的模型可用来与消费者分享 API 收入：

- 广告收入分成。有些 API 提供商提供广告网络作为其平台的一部分。API 消费者在其网站和应用中嵌入广告，为 API 提供商提供收入。反过来，API 提供商会从广告中返回部分收入。
- 加盟。 一些网站盈利方法已应用于 API 生态系统。通常使用单次营收成本（CPA）、每次点击成本（CPC）以及一次性或重复收益分享模型。
- 记入账单。小部分 API 提供商为消费者采用了付费模式。基于广告收入分成或加盟收入时，提供商会将收入记入 API 消费者的账单，从而降低开发人员的整合开销，或许还能降低 API 提供商的开支。

## 间接货币化

API 的间接货币化并不总是通过 API 访问、广告或其他收入中产生收入。API 可以通过以下间接方式来创造价值。

1. 营销工具。

API 可以用作公司及其在线业务的营销工具。通过明智的品牌战略，开发人员可以成为第三方营销代理，代表核心公司及其品牌工作。

2. 品牌意识。

作为整体营销和品牌战略的新工具，API 可以通过第三方网站和应用提供一种品牌曝光，从而使用第三方 API 消费者作为引擎扩大品牌的覆盖范围。

3. 内容获取。­

并非所有 API 都涉及向消费者提供内容、数据和其他资源。API 通常允许编写、更新、访问和删除内容。通过 API 获取内容可能是在公司及其平台内创造价值的好方法。

4. SaaS（软件即服务）。

软件即服务（SaaS）已成为向消费者和企业在线销售软件的常用方法。通常，API 将补充核心软件及其产品，为 SaaS 用户提供价值。API 访问通常作为核心 SaaS 平台的组成部分包含在内，但也可以作为适用于高级 SaaS 用户的选项来交付。

5. 流量生成。

API 还可用于推动现有网站或应用的流量。设计 API 以使用连接到中央网站或应用的超链接，并鼓励消费者构建自己的与 API 集成的网站和应用，为增加流量提供绝佳机会。

---

许多公司首先专注于启动和发展其 API 策略，并在全面执行其 API 货币化策略之前获得必要的经验，完全依赖 API 提供的间接价值。

虽然早期制定货币化策略更好，但许多人通过优先考虑 API，其次考虑货币化，也获得了成功。通过在公司内部、私下在合作伙伴之间或公开等各种方式部署 API，可以使用多种货币化策略。

一些 API 资源更适合即用即付模式，而一些市场要求可以自由访问数据，且无需注册或支付访问费用。没有通用的 API 货币化方法。

可作为公司内部的外部研发实验室来考虑 API。接受合作伙伴的想法和整合的实验室可以将这些想法付诸实施，创建应用并培养业务关系。公司正在使用 API 来引入外部想法和人才，以期激励创新。

一些 API 提供商将手动选择最佳整合并投资个人和公司，有时这样就能与相关公司达成合作并获得所需技术。

就像没有通用的 API 货币化方法一样，定价或访问量也不固定。成功的 API 提供商都在不断调整、优化和试验，试图尽可能找到最具竞争力的方法。API 涉及业务开发，以及寻找通过新资源和现有资源获利的新方法。

## 路线图

API 提供商与 API 消费者一直在努力取得彼此的信任并建立合作关系。这种信任的一个关键方面，也是这种关系的基础，共用一个通用路线图。API 提供商需要主动让 API 消费者参与 API 资源的使用，以便消费者做好应对这些变化的准备、做出相应的调整并提供可能影响路线图的反馈。没有什么会比 API 消费者不知道 API 的情形，以及应用所出现的变化或故障更令其感到惊讶，更快让 API 消费者感到沮丧的了。

## API 生态系统

API 开始部署挂起和管理少量 API 的 API 区域，消费者可以在这里访问这些 API 并将其投入使用。但目标是将 API 区域发展为 API 消费者的活跃社区，希望将其转变为一个由充满激情的合作伙伴和消费者组成的自助式自我管理生态系统。

可持续的 API 生态系统具有共生性。它们不仅仅关乎 API 提供商产生价值，还关乎 API 用户获得成功所需的资源并参与新的业务开发方法。

活动 API 会吸引新用户。能够获得所寻求的价值和所需支持的用户将口口相传。无论是技术、业务和政策，都离不开可行的 API 生态系统。需要实现平衡，不仅为 API 提供商和消费者提供价值，而且为与 API 资源集成的 Web 或移动应用的最终用户提供价值。

## API 机会

除了 API 使用方面的这些趋势之外，企业和开发人员还有很多机会可以利用。基于 Web 的简易资源访问方法正被逐步运用于全新的领域，例如：

- 3D 打印。借助 Web API，3D 打印正在超越业余爱好和艺术范围，并具有重新定义全球制造业格局的巨大潜力。有几个平台专注于为 3D 打印提供 API。
- 汽车。福特和通用汽车等主要汽车制造商正在将汽车转变为 API 平台，使企业和开发人员有机会提供车载新产品和服务。
- 家庭。设备在我们的日常生活中发挥着核心作用。我们将智能设备从家里带到工作场所，带到我们去到的各个地方。API 已超越我们的计算机，直接融入我们的家庭。从供暖和空调用恒温器到照明和居家监控，相关企业正在积极开发新一代的家庭自动化技术。虽然大多数家庭自动化技术仍然没有 API，但许多提供商正在引入开发人员生态系统，并正在使用 API 来激励围绕家庭技术集成的创新。
- 建筑物。许多建筑物已经拥有自动加热、空气、电气、水和其他系统。建筑设备制造商很快就会意识到允许 API 访问其硬件和软件的重要性。试想一下，如果建筑物能够教会我们减少能源消耗，实时诊断问题，并在必要时自我纠正，或者在需要维修或调整时致电服务提供商，情况会如何。
- 自我量化。能让佩戴者加深自我了解的设备无处不在。很多自我量化设备都能监测个人的运动和健身活动情况。它们可用于从生活方式追踪到医疗保健的一切事务。

这 5 个领域仅代表 API 可提供的少数机会。API 不仅仅是互联网上的应用，它们还将我们的物质世界连接到我们所依赖的云计算和数据流。

---

# 什么是 API 设计？

[原文](https://www.redhat.com/zh/topics/api/what-is-api-design)

## 概述

API 设计是指开发应用程序编程接口（API）的过程，该接口可公开数据和应用程序功能以供开发人员和用户使用。API 对于现代企业而言至关重要，可以为其运营和产品以及合作伙伴战略等各方面增加新的功能。大多数企业对于是否应该开发 API 程序已不再存有疑虑，而是想要知道具体的实践方法。

有效的 API 程序必须建立在企业的总体战略基础之上，并助力其实现目标。当您能够明确回答以下 3 个问题时，您便可确定自己将会制定出有效的战略：

- 我们为何需要实施 API？
- 我们希望通过这些 API 实现哪些具体成果？
- 我们如何计划执行 API 程序来实现这一目标？

### 原因

人们经常以不同的方式误解这个问题。首先，要思考 API 效果的价值，而不是关注 API 本身的价值。请记住，企业的核心业务才是有价值的，不一定是 API。当 API 成为提供对企业所提供的现有价值的新访问类型的渠道时，它就很有价值。

另一个常见错误是认为 API 本身很有价值，用户必须准备为其付费。仅当 API 本身是产品时才是这样。在大多数模型中，情况并非如此。API 通常会推动其他一些指标——销售、会员推荐、品牌知名度等。API 对用户的价值是 API 调用（服务请求和响应）的结果，而不是调用本身。

根据 Cutter Consortium 和 Wipro 对 152 家企业进行的调查，建立 API 计划的最常见业务驱动因素是开发新的合作伙伴关系，增加收入，利用新的商业模式，缩短产品上市时间，以及开发新的分销渠道。最重要的技术驱动因素是改进应用集成，改进移动集成，并支持与更多设备的连接。API 所能带来的益处必须足够诱人，以便促使企业毫不犹豫地选择进行 API 投资。

### 内容

第二个问题是"我们希望通过这些 API 实现哪些具体成果？" 换言之，"API 的实际用途是什么及其对更广泛的业务战略有何影响？"

企业的内部视图和外部视图概念都有助于定义 API 的内容。内部视图是指企业拥有的具体且有价值的资产。提供的服务和资源越是有价值和独特，就越适合用于 API 程序。

拥有特有数据的企业可以允许通过 API 来访问这些数据，以便充分利用这一资源。特有的内容、数据和服务会让 API 访问权限变得异常宝贵。

在决定 API 应该为企业做什么时，需要检查
内部和外部视图。而有关内容的决定通常是这 2 种视图的结合。

具体而言，虽然原因不太可能经常改变，但根据市场、技术考虑因素或经济条件等外部因素的不同，内容可能会有很大差异。关于资产价值的内部指示可能会发生变化，这也可能会影响使用 API 应该实现的目标。

### 方式

最后一个问题，"我们如何设计 API 程序来实现我们的需求？"全在于实现和执行。

团队必须自问：

- 使用什么技术来构建 API？
- 如何设计 API？
- 如何维护 API？
- 如何在企业内部推广 API 或外销 API？
- 哪些资源可用？
- 谁应该加入团队?
- 我们如何根据已设定的业务目标获得成功？

## 对您的 API 而言，这意味着什么？

查找和描述 API 的价值是一个迭代过程。第一步是描述用户将尝试完成的工作。例如：

- 在紧急情况下自动向团队成员发送紧急通信
- 备份关键文件以确保它们永不丢失
- 对数据进行采样以检测特定事件

接下来，确定会在尝试完成工作之前、期间或之后影响用户的具体难题：

- 通过多次尝试、检测故障、担心发送多个消息而不只是一个消息，并根据用户的位置与不同的消息传送系统集成，确保发送可靠性
- 确保安全传送文件，同时还要最大限度地减少传输带宽
- 处理大量数据并尝试实时关联它

第三步是总结用户可能获得的潜在收益：

- 发送其他类型的通知，这些通知创建机会而非威胁警告
- 如果可靠性能达到您的要求，则可去除其他存储设备
- 根据事件自动触发操作

在审视这些痛点时，请多多思考，并列出支持、文档或开发人员门户等内容，以及用户可以使用的所有内容。接下来，概述您打算如何消除或减少在尝试完成作业之前、期间或之后可能令 API 用户烦恼的一些事情，或者阻止他们这样做的问题。然后描述您打算如何为 API 用户创造任何形式的收益。

通过参与此过程，我们上面的 3 个示例可能会导致：

- 多通道消息传递 API，只需一次调用即可传递消息，并且能够自动重试直至保证送达（例如，Twilio、PagerDuty）。
- 具有优化调用的存储同步 API，以有效地检查是否应同步新版本（例如，Bitcasa、Box）。
- 将多个数据源聚合为一个可配置流的 API，可对其进行过滤、采样和轻松操作（例如，GNIP、DataSift）。

最后，进行一个有用的澄清练习，即组合几个语句，使 API 和用户配置文件之间的适配清晰。如果您发现难以识别这样的适配语句，则需要重新考虑 API 模型。也许有 API 功能需要添加、修改、改进或消除。也可能是您的 API 确实提供了很大的价值，但您正在尝试解决用户的错误类型。

然后，当您将适配语句压缩为一个总体语句时，它就成为您 API 的价值主张。对于上面的消息传递 API，这可能是这样的：

> 我们的消息传递 API 为企业开发人员提供可靠、有保证、无延迟的文本消息传递功能，用于高度关键的业务应用。软件开发工具包（SDK）也支持此 API，涵盖最常用的编程语言，以实现快速集成。

有时，您可能会想"这好像太复杂了。我们只不过是要创建一个内部 API。" 但是，即使在内部用例中，对于价值的关注也至关重要。定义不明确的价值主张将导致难以将 API 推销给其他团队。定义明确的价值主张不但有助于 API 程序的采纳推广，还能使其成为业务的主要促进因素。

为帮助定义您自己的 API 程序的价值，请考虑以下 5 个问题：

1. 谁是用户？

这个问题应根据他们与您的关系（他们是现有客户、合作伙伴还是外部开发人员）、他们的角色（他们是数据科学家、移动开发人员还是运维人员）以及他们的要求或偏好来回答。

2. 我们要解决哪些用户痛点和/或为用户创造什么收益？

这个问题应根据与客户业务的关系、价值主张中确定的难题和收益、是否满足关键需求（这是痛点还是收入机会），以及正在为用户改进的衡量标准（速度、收入、成本节省、创新能力）来回答。

3. 您的 API 支持哪些用例？

借助价值主张，识别对您所在企业和用户最有效的用户难题解决方案或 API 商机。计划 API 以解决这些用例。

4. 如何随着时间的推移扩大用户的价值？

计划您的价值主张，并考虑未来的变化。与内部或外部变化相关的即将到来的重要里程碑是什么？

5. 将在内部为您的企业创造什么价值？

考虑内部收益以及 API 如何在业务中具有价值。

## 从一开始就明确业务模式

在设计基于 API 的程序时，务必要能阐明 API 的价值。但是，API 也会产生成本，这一考虑应该通过价值来平衡。虽然价值可能无法以货币形式衡量，但必须是真实的。例如：

- 企业的现有核心业务是什么？
- 如何使用 API 来加速或扩充企业的业务发展？

在某些情况下，API 可以在企业的现有业务模式之外产生全新的商机。但即使在这种情况下，API 通常也会利用现有资产或专业知识以新的方式来创造商机。

总之，以下 3 点就是为什么确定正确的业务模型对于设计有效的 API 程序而言至关重要的原因：

- 确定正确的业务模型可以突显 API 对于企业的价值，这推动了关于 API 程序长期承诺的决策。如果没有这种承诺，很少有资源可用于完成建立和运行有效 API 程序所需执行的任务。
- 确定正确的业务模型有助于定义产品的功能，这是满足第三方并推动业务发展所需的。
- 确定正确的业务模型可确保考虑企业内的角色和职责，以及谁保留 API 生成的价值的哪些部分。这也意味着定义使用 API 能为 API 用户带来的收益以及如何与 API 提供商的收益进行平衡。

## 在设计和实施时考虑用户

好的 API 设计有一些核心原则，这些核心原则在实施上可能有所不同。就好比：每辆车都有方向盘、刹车踏板和加速器。您可能会发现各款车型的危险警告灯、行李箱释放装置或收音机略有不同，但很少有经验丰富的司机不知道如何驾驶出租车。

这种"驾驶就绪"设计水平正是出色的 API 团队所追求的——经验丰富的从业者很少或不需要解释就能开始使用的 API。

### 简单性

API 设计的简单性取决于环境。特定设计对于一个用例可能很简单，但对另一个用例来说非常复杂，因此必须平衡 API 方法的粒度。在多个层面上考虑简单性可能很有帮助，包括：

- 数据格式。支持 XML、JSON、专有格式或组合。
- 方法结构。方法可以非常通用、返回一组广泛的数据，或者非常具体以允许有针对性的请求。方法通常还以特定顺序调用以实现某些用例。
- 数据模型。底层数据模型可能与通过 API 实际显示的内容非常相似，也可能大不相同。这会影响可用性和可维护性。
- 身份验证。不同的身份验证机制具有不同的优缺点。最合适的机制取决于环境。
- 使用策略。开发人员的权利和配额应易于理解和使用。

### 灵活性

简化 API 可能会与使其变得灵活相冲突。仅考虑简单性而创建的 API 存在过度定制的风险，仅为非常具体的用例提供服务，对于其他用例而言可能不够灵活。

要建立灵活性，首先要找出潜在的操作空间基于什么，包括底层系统和数据模型，以及定义这些操作的哪些子集是可行且有价值的。为了在简单性和灵活性之间找到适当的平衡：

- 尝试公开原子操作。通过组合原子操作，可以覆盖整个空间。
- 确定最常见和最有价值的用例。设计第二层元操作，该操作结合多个原子操作来为这些用例提供服务。

按理说，超媒体即应用状态引擎（HATEOAS）的概念可以进一步提高灵活性，因为它允许在 API 和客户端操作中更改运行时。HATEOAS 通过简化版本控制和文档编制确实提高了灵活性，但是，在 API 设计中，必须考虑许多问题。

## 需要考虑的关键问题

为了全面思考您的 API 设计，请考虑以下 5 个问题：

1. 我们是否设计了 API 来支持我们的用例？

确定主要用例之后的下一步是设计 API 以使其支持这些用例。灵活性很重要，以免排除可能不那么频繁但仍应受支持的任何用例，以允许创新。

2. 我们是否要为此使用 RESTful？

RESTful API 目前很流行。但是，不应该仅仅为了这个目的而追随这一趋势。有些用例非常适合它，但其他用例优选其他架构风格，比如 GraphQL。

3. 我们是否在未考虑用例的情况下公开了自己的数据模型？

API 应得到实际数据模型中抽象出来的层的支持。一般说来，没有直接进入数据库的 API — 尽管可能存在需要的情况。

4. 哪些地理区域最重要，我们是否相应地规划了数据中心？

API 设计还必须涵盖延迟和可用性等非功能性元素。确保选择地理位置接近您拥有大多数用户的数据中心。

5. 我们是否正在将 API 设计与其他产品同步？

如果 API 不是您公司的唯一产品，请确保 API 设计与其他产品的设计协调一致。您可能决定将 API 设计与其他产品完全分离。即使在这种情况下，也需要明确将 API 设计与其他产品完全分离的具体计划，并在企业内部和外部进行相应的沟通。

## 关注开发人员体验

改进 API 设计以便于采用的关键指标是"Time to first hello world"（TTFHW，即"首次问世时间"）。换言之就是，开发人员需要多长时间才能使用您的 API 创造出最小可行产品？这是让自己为开发人员着想的好方法，开发人员想测试您的 API 来了解如何使某些工作变得有效。

当您定义 TTFHW 指标的开始和结束时，我们建议尽可能多地涵盖开发人员参与流程。然后优化它，使其尽可能快捷方便。

能够快速完成整个过程还可以使开发人员确信 API 组织得很好，并且事情可能正常工作。将"成功时刻"延迟得太久可能有失去开发人员的风险。

除了 TTFHW，我们还推荐一个指标："Time to first profitable app"（TTFPA，即"首次盈利应用时间"）。这更为棘手，因为"盈利"是一个定义问题，具体取决于您的 API 和业务战略。考虑到这一点很有帮助，因为它会迫使您将与 API 操作相关的方面视为 API 程序的一部分。

开发人员体验的两个基本原则是：

- 设计一种产品或服务，为开发人员提供明确的价值并应对显而易见的难题或商机。这可以是货币价值或某些其他价值，例如提高覆盖率的方式、品牌知名度、客户群、间接销售、开发人员声誉或使用有效先进技术的纯粹乐趣。
- 产品需要易于访问。这可以包括具有轻量级注册机制（或者根本没有）、测试功能访问、优秀文档以及大量免费和整洁的源代码。

我们建议大多数 API 程序都应该有一个开发人员程序 — 无论您是公开 API，仅向合作伙伴公开，还是仅在内部公开。根据受众的不同，这些规定可能或多或少都很复杂。

### 开发人员门户

开发人员门户是开发人员计划的关键要素，是开发人员注册、访问和使用 API 的核心入口点。访问 API 对于开发人员来说应该是简单顺畅的。开发人员应能够快速开始使用您的 API。

TTFHW 是衡量这一点的最佳指标。您还应该考虑简化注册过程 — 更简单、更快捷、更好。建议的最佳实践是开发人员应该能够调用您的 API 来检查他们的行为（请求和响应），而不需要任何注册。此外，补充内容（如入门指南、API 参考文档或源代码）可以缩短学习曲线。

### 通过生态系统合作伙伴加速

作为 API 提供商，您在合作伙伴和供应商的生态系统中运营。这些合作伙伴通常拥有自己的内容分发和通信网络及方式。我们建议您确定联盟，这有助于提高 API 的采用率。通常，当 API 互补时，可以找到这种联盟，并在组合时为开发人员提供价值。

评估开发人员体验要考虑的问题：

1. 我们如何在前 5 分钟解释 API 的价值？

开发一个关于最适合开发人员的 API 的价值主张的"电梯行销"。

2. 我们的 TTFHW 和 TTFPA 是什么，如何减少它？

这是一种通过考虑端到端 TTFHW 来提高 API 开发人员友好性的强大方法。在考虑会影响开发人员体验的任意元素（如门户网站）以及 API 的各项变因时，我们建议您一定要考虑 TTFHW 和 TTFPA 指标。

3. 开发人员的入职流程是什么，是否做到了尽可能精简？

这需要与您的 API 的用例保持一致。对于更敏感的 API 或数据访问，自然需要更高的安全级别，这就可能需要更多正式协议。对于别的一切，它应该非常简单直观，以便使早期开发人员获得成功（TTFHW）。

4. API 是否足够灵活以确保其对开发人员具有吸引力？

如果您找到了正确的价值主张，并且开发人员注册了您的 API，那就太棒了。请记住，帮助他们取得成功不仅会留住他们，而且会增加他们的数量。

5. 如果开发人员遇到问题，我们如何提供支持？

我们相信自助服务方法，这将有助于您扩展。好的文档、常见问题解答或论坛可以解决开发人员的许多问题。但是自助服务有其局限性，对于更深入的问题或其他复杂情况（如发票问题），应该有某种支持机制。

6. 我们的文档是否有助于创新？

对于那些使用非常规用例或想要进行创新的开发人员，我们的文档能够提供哪些支持？任何事物都有可能激发伟大的创意。

# 什么是 API 网关？

## 概述

API 网关是位于客户端与后端服务集之间的 API 管理工具。

API 网关相当于反向代理，用于接受所有应用编程接口（API）调用、整合处理这些调用所需的各种服务，并返回相应的结果。

## API 网关在 API 管理中的作用

API 网关是 API 管理系统的一部分。API 网关会拦截所有传入的请求，然后通过 API 管理系统（该系统负责处理各种必要的功能）将其发送出去。

API 网关的工作因实施不同而异。一些常见的功能包括：身份验证、路由、速率限制、计费、监控、分析、策略、警报和安全防护。

## API 网关如何支持 DevOps 和无服务器环境

在采用 DevOps 方法的企业中，开发人员会使用微服务以快速、迭代的方式构建和部署应用。API 是最常见的微服务通信方式之一。

此外，包括无服务器模型在内的现代云开发都要依靠 API 来置备基础架构。您可以部署无服务器功能并使用 API 网关进行管理。

总之，随着集成和互联变得愈加重要，API 的重要性也在提升。随着 API 复杂性的提高和使用量的增长，API 网关的价值也日益得到体现。

---

# 什么是 GraphQL

[原文](https://www.redhat.com/zh/topics/api/what-is-graphql)

GraphQL 是一种用于[应用编程接口（API）](#api-接口是什么意思？)的查询语言和服务器端运行时，它可以使客户端准确地获得所需的数据，没有任何冗余。

## GraphQL 有什么用？

GraphQL 旨在让 API 变得快速、灵活并且为开发人员提供便利。它甚至可以部署在名为 [GraphiQL](https://github.com/graphql/graphiql) 的集成开发环境（IDE）中。作为 [REST](#什么是-rest-api) 的替代方案，GraphQL 允许开发人员构建相应的请求，从而通过单个 API 调用从多个数据源中提取数据。

此外，GraphQL 还可让 API 维护人员灵活地添加或弃用字段，而不会影响现有查询。开发人员可以使用自己喜欢的方法来构建 API，并且 GraphQL 规范将确保它们以可预测的方式在客户端发挥作用。

## 模式、解析器及其他常见的 GraphQL 术语

API 开发人员使用 GraphQL 创建一个模式，用于描述客户端可通过该服务查询的所有可能数据。

GraphQL 模式由对象类型组成，它表示可以请求哪种对象以及它有哪些字段。

有查询时，GraphQL 会根据模式对查询进行验证。随后，GraphQL 将执行经过验证的查询。

API 开发人员将模式中的每个字段附加到名为**解析器**的函数中。执行期间，系统将调用解析器来生成相应的值。

除了为 API 查询定义和验证语法外（有关概述见 [graphql-spec](https://github.com/graphql/graphql-spec) 存储库），GraphQL 把大部分决策权都留给了 API 设计人员。GraphQL 不提供有关如何存储数据或使用哪种编程语言的任何指导；开发人员可以使用 PHP（[graphql-php](https://github.com/webonyx/graphql-php)）、Scala（Sangria）、Python（[Graphene Python](https://graphene-python.org/)）、Ruby（[graphql-ruby](https://graphene-python.org/)）、JavaScript（[graphql.js](https://www.npmjs.com/package/graphql)）等等。GraphQL 对网络、授权或分页没有任何要求。

从客户端的角度看，最常见的 GraphQL 操作可能就是查询和修改。如果按照创建、读取、更新和删除（CRUD）模型来审视这些操作，那么查询就等同于读取。其他所有操作（创建、更新和删除）均视为修改。

## GraphQL 的优缺点

1. GraphQL 的优点

- GraphQL 模式会在 GraphQL 应用中设置单一事实来源。它为企业提供了一种整合其整个 API 的方法
- 一次往返通讯可以处理多个 GraphQL 调用。客户端可得到自己所请求的内容，不会超量
- 严格定义的数据类型可减少客户端与服务器之间的通信错误
- GraphQL 具有自检功能。客户端可以请求一个可用数据类型的列表。这非常适合文档的自动生成
- GraphQL 允许应用 API 进行更新优化，而无需破坏现有查询
- 许多开源 GraphQL 扩展可提供 REST API 所不具备的功能
- GraphQL 不指定特定的应用架构。它能够以现有的 REST API 为基础，并与现有的 API 管理工具配合使用

2. GraphQL 的缺点

- 即便是熟悉 REST API 的开发人员，也需要一定时间才能掌握 GraphQL
- GraphQL 将数据查询的大部分工作都转移到服务器端，由此增加了服务器开发人员工作的复杂度
- 根据不同的实施方式，GraphQL 可能需要不同于 REST API 的 API 管理策略，尤其是在考虑速率限制和定价的情况下
- 缓存机制比 REST 更加复杂
- API 维护人员还会面临编写可维护 GraphQL 模式的额外任务

## GraphQL 与开源

GraphQL 由 Facebook 开发，并于 2012 年首次应用于移动应用。GraphQL 规范于 2015 年实现开源。现在，它受 GraphQL 基金会监管。

有大量开源项目都涉及 GraphQL。下面的列表虽不详尽，但大致涵盖了一些旨在促进 GraphQL 普及的项目。

- [Apollo](https://www.apollographql.com/)：一个包含前端客户端库（[Apollo 客户端](https://www.apollographql.com/client/)）和后端服务器框架（Apollo 服务器）的 GraphQL 平台。
- [Offix](https://offix.dev/)：一个离线客户端，即使在无法访问应用的情况下也允许执行 GraphQL 修改与查询。
- [Graphback](https://graphback.dev/)：一个用于生成支持 GraphQL 的 Node.js 服务器的命令行客户端。
- [OpenAPI-to-GraphQL](https://github.com/IBM/openapi-to-graphql)：一个用于将 OpenAPI 规范或 Swagger 所描述的 API 转换为 GraphQL 的命令行界面和库。

---

# API 接口是什么意思？

[原文](https://www.redhat.com/zh/topics/api/what-are-application-programming-interfaces)

应用编程接口（API）是一组用于构建和集成应用软件的定义和协议。

## API 发行政策

1. 私有

这类 API 仅供内部使用，能让公司最大限度地控制自己的 API。

2. 合作伙伴

您会和特定的业务合作伙伴共享这类 API。它能在不影响质量的情况下带来额外收益。

3. 公共

这类 API 可供所有人使用。第三方可以使用这类 API 来开发应用，以便与您的 API 进行互动或实现某种创新。

## API 简史

API 概念的出现，始于计算机时代的初期，远远早于个人电脑诞生之前。当时，API 常被当作操作系统的库，而且基本上都在本地系统上运行，仅偶尔用于大型机之间传递消息。将近 30 年后，API 走出了它们的本地环境。到了 21 世纪初，API 成为了用于实现数据远程集成的一种重要技术。

## 远程 API

远程 API 旨在通过通信网络进行互动。这里的远程是指 API 操控的资源不在提出请求的计算机上。由于互联网是应用最广泛的通信网络，所以大多数 API 都是基于 Web 标准来设计的。并非所有的远程 API 都是 Web API，但可以认为 Web API 都是远程 API。

## SOAP 和 REST

随着 Web API 的不断普及，相应的协议规范也随之产生了，从而推动了信息交换的标准化：简单对象访问协议，简称 SOAP。使用 SOAP 设计的 API 会使用 XML 格式来收发消息，并通过 HTTP 或 SMTP 来接收请求。使用 SOAP 时，在不同环境中运行的应用或使用不同语言编写的应用能够更加轻松地共享信息。

相关的规范还有一个，即表述性状态传递（[REST](#什么是-rest-api) ）。遵循 REST 架构约束的 Web API 被称为 RESTful API。REST 与 SOAP 有着根本区别：SOAP 是一种协议，而 REST 是一种架构风格。这意味着 RESTful Web API 没有官方标准。正如 Roy Fielding 在论文“Architectural Styles and the Design of Network-based Software Architectures”（架构模式以及基于网络的软件架构的设计）中定义的那样，只要 API 符合 RESTful 系统的 6 个导向性约束，就算作 RESTful API：

- 客户端/服务器架构：REST 架构由客户端、服务器和资源构成，通过 HTTP 来处理请求
- 无状态：请求所经过的服务器上不会存储任何客户端内容。与会话状态相关的信息会存储在客户端上
- 可缓存性：通过缓存，可免去客户端与服务器之间的某些交互
- 分层系统：客户机与服务器之间的交互可以通过额外的层来进行调解。这些层可以提供额外的功能，如负载均衡、共享缓存或安全防护
- 按需代码（可选）：服务器可通过传输可执行代码来扩展客户端的功能
- 统一接口：这项约束是 RESTful API 的设计核心，共涵盖 4 个层面

  - 识别请求中的资源：请求中的资源会被识别，并与返回给客户端的表示内容分离开来
  - 通过不同的表示内容来操纵资源：客户端会收到表示不同资源的文件。这些表示内容必须提供足够的信息，以便执行修改或删除操作
  - 通过不同的表示内容来操纵资源：客户端会收到表示不同资源的文件。这些表示内容必须提供足够的信息，以便执行修改或删除操作
  - 将超媒体作为应用状态的引擎：在访问某个资源后，REST 客户端应该能够通过超链接来发现当前可用的所有其他操作

虽然看似有很多约束需要遵循，但是这些约束遵循起来要比遵循规定的协议容易得多。因此，RESTful API 现在变得比 SOAP 更为普及。

近年来，OpenAPI 规范已发展成为定义 REST API 的通用标准。OpenAPI 为开发人员提供了一种与语言无关的方式来构建 REST API 接口，从而最大程度减少不确定的因素，让用户安心工作。

另一个新兴的 API 标准是 GraphQL，这是一种可替代 REST 的查询语言和服务器端运行时。GraphQL 可优先让客户端准确地获得所需的数据，没有任何冗多余。作为 REST 的替代方案，GraphQL 允许开发人员构建相应的请求，从而通过单个 API 调用从多个数据源中提取数据。

## SOA 与微服务架构

最常使用远程 API 的 2 种架构方案分别是：面向服务的架构（SOA）和微服务架构。在这 2 种方案中，SOA 的历史更为久远一些。最初，它是在单体式应用的基础上经过改进而形成的。虽然单个单体式应用也可以完成各种操作，但通过某种集成模式（如企业服务总线（ESB））在不同应用间实现松散耦合后，即可获得某些功能。

从大多数层面来看，SOA 都要比单体式架构更简单；但是，如果无法明确理解各种组件交互，SOA 也可能会进一步加剧整个环境的复杂性。这种复杂性的加剧会重新引发 SOA 想要解决的某些问题。

对于专用松散耦合服务的使用，微服务架构与 SOA 模式类似。但是，微服务架构会对传统架构进行进一步细分。在微服务架构中，服务会采用通用消息传递框架，如 RESTful API。它们会使用 RESTful API 来实现相互通信，且无需执行繁琐的数据转换处理或使用其他的集成层。使用 RESTful API 可以加速新功能和新更新的交付；甚至还可以说，是这类 API 促进了这种速度的提升。该架构中的每一个服务都呈离散状态。一个服务可以被取代、增强或丢弃，而不会影响架构中的任何其他服务。这种轻量级架构有助于优化分布式资源或云资源，而且能够支持个别服务的动态扩展。

## API 和 Webhook

Webhook 是一种基于 HTTP 的回调函数，可在 2 个 API 之间实现轻量级的事件驱动通信。许多种类的应用使用 Webhook 来从其他应用接收少量数据，但 Webhook 也可用于在 GitOps 环境中触发自动化工作流。

Webhook 通常被称为逆向 API 或推送 API，因为它们让通信责任落在了服务器而不是客户端身上。不再是客户端发送 HTTP 请求来索取数据，直到服务器响应为止，而是服务器等到数据可用时向客户端发送一个 HTTP POST 请求。虽然有这样的昵称，但 Webhook 不是 API；两者相互配合。应用必须具有 API 才能使用 Webhook。

---

# 什么是 Webhook？

Webhook 是一种基于 HTTP 的回调函数，可在 2 个应用编程接口（API）之间实现事件驱动的轻量级通信。许多 Web 应用都使用 Webhook 来接收来自其他应用的少量数据，但 Webhook 也可用于在 GitOps 环境中触发自动化工作流。

Webhook 可以将事件源连接到自动化解决方案，因此，它可以用来启动事件驱动型自动化以便在发生特定事件时执行各种 IT 操作。

## Webhook 用于应用开发

### 什么是 API？

API 由一组用于构建和集成应用软件的定义和协议组合而成。有时我们可以将 API 之间的通信视为信息用户和信息提供者之间的合约，它规定了消费者（调用方）需要提供的内容和提供者（响应方）需要提供的内容。这种关系也可描述为客户端应用调用服务器应用，但这两个角色可以互换，具体取决于特定情景中的哪个应用在请求数据。

Web API 通常使用 HTTP 从其他应用请求数据，并定义响应报文的结构，其通常采用 XML 或 JSON 文件格式。XML 和 JSON 均为首选格式，因为二者都以结构化方式呈现数据，易于其他应用处理。

当客户端 API 从服务器 API 请求数据时，它会通过调用来了解是否发生了特定的事件，即服务器的数据是否发生了可能对客户端有用的变化。在这个过程（称为轮询）中，客户端以固定间隔发送 HTTP 请求，直到服务器 API 发送相关的数据，此数据有时称为有效负载（Payload）。

客户端应用并不知道服务器应用的状态，因此会轮询服务器 API 来获取更新，不断调用到发生特定事件为止，但服务器只会在信息可用时发送所请求数据。客户端应用必须一直请求更新，并等待到相关事件发生为止。

### Webhook 有何不同？

要设置 Webhook，客户端需向服务器 API 提供唯一的 URL，并指定其要了解的事件。设置 Webhook 后，客户端不再需要轮询服务器。发生特定的事件时，服务器会自动将相关的有效负载发送到客户端的 Webhook URL。

Webhook 通常被称为“反向 API” 或“推送 API”，因为通信责任落在了服务器而非客户端上。与客户端不断发送 HTTP 请求来请求数据，直至服务器作出响应的方式不同，服务器在数据可用时会立即向客户端发送一个 HTTP POST 请求。虽然有这些别名，但其实 Webhook 并非 API，二者可以结合使用。应用必须具有 API 才能使用 Webhook。

Webhook 这一名称取自 Web（表明指的是基于 HTTP 的通信）与 hooking 编程函数（允许应用截获调用或可能感兴趣的其他事件）。Webhook 可“钩住”服务器应用上发生的事件，并提示服务器通过 Web 将有效负载发送到客户端。Jeff Lindsay 在 2007 年发表的一篇名为[《Webhook 革新 Web 世界》（Web hooks to revolutionize the web）的博客文章推动了这一概念的普及](https://progrium.github.io/blog/2007/05/03/web-hooks-to-revolutionize-the-web/)。

IT 团队可以利用多种方式来保护通过 Webhook 通信的应用。大多数支持 Webhook 的应用都会将一个机密密钥添加至有效负载的请求标头中，以便客户端确认服务器的身份。Webhook 通常由相互传输层安全（mTLS）身份验证提供保护，这种方式会在发送有效负载之前对客户端和服务器进行验证。此外，客户端应用通常会对 Webhook URL 使用 SSL 加密，确保传输的数据保持私密。

### Webhook 有以下这些优点：

- 无需轮询：这可为客户端应用节省资源。
- 易于设置： 如果某款应用支持 Webhook，便可通过服务器应用的用户界面轻松对其进行设置。在这个界面中，用户只需输入其应用的 Webhook URL 并设置一些基础参数，例如要关注哪些事件。
- 自动传输数据：服务器应用上发生特定事件时会立即发送有效负载。这种数据交换是由事件触发的，因此发生速度与数据从服务器传输到客户端一样快，实时性可以媲美任何数据传输。
- 适合特定的轻量级有效负载： Webhook 依靠服务器来确定所发送的数据量，然后客户端去解译有效负载并以高效的方式加以使用。客户端不会控制数据传输的确切时间或大小，因此，Webhook 能够处理 2 个端点之间的少量信息，这些信息通常采用通知的形式。

## Webhook 用于基础架构的自动化

Webhook 最常用于简化两个应用之间的通信，但也可用于自动化基础架构即代码（IaC）工作流以及启用 GitOps 实践。

### 什么是基础架构即代码（IaC）？

基础架构即代码（IaC）是通过代码（而非手动流程）来管理和置备基础架构的方法。版本控制是 IaC 的重要组成部分，配置文件应像任何其他软件源代码文件一样处于源代码的控制之下。以基础架构即代码方式部署还意味着基础架构可被划分为若干模块化组件，然后通过自动化以不同的方式进行组合。

借助 IaC 实现基础架构置备的自动化，意味着开发人员无需再在每次开发或部署应用时手动置备和管理服务器、操作系统、存储及其他基础架构组件。将基础架构的配置和部署以代码形式定义下来，可供置备时有模板可循。这一过程仍然可以手动完成，但也可以利用企业级预期状态引擎（如红帽 ® Ansible® 自动化平台）实现流程的自动化。

### 什么是 GitOps？

GitOps 通常被认为是 IaC 的演变，它是一种通过 Git（一种开源版本控制系统）来管理基础架构和应用配置的战略方法。遵循 GitOps 实践时，开发人员将 Git 用作声明性基础架构和应用的单一数据源，并通过 Git 来拉取请求以实现基础架构置备和部署的自动管理。Git 存储库包含系统的完整状态，因此，更改记录既可查看也可审计。

### Webhook 发挥着什么样的作用？

Webhook 可减少实施和管理以 Git 为中心的部署管道所需的步骤，且可用于自动启动整个 IaC 工作流。在 GitOps 环境中，Git 存储库充当可信来源，Webhook 发挥的作用与它在 2 个应用之间所起到的作用相同。被特定事件触发后，某个 API 会将有效负载发送至另一个 API。不同之处在于触发 Webhook 的事件类型以及接收方如何处理有效负载。

Webhook 可减少实施和管理以 Git 为中心的部署管道所需的步骤，且可用于自动启动整个 IaC 工作流。在 GitOps 环境中，Git 存储库充当可信来源，Webhook 发挥的作用与它在 2 个应用之间所起到的作用相同。被特定事件触发后，某个 API 会将有效负载发送至另一个 API。不同之处在于触发 Webhook 的事件类型以及接收方如何处理有效负载。

如果预期状态引擎支持自动化，这些 Webhook 还可以启动 IaC 工作流以将代码更改转化为自动化操作。例如，系统管理员可以设置每当收到 Webhook 的有效负载时都运行的自动化操作，从而自动在其托管的主机上应用新的代码更改，然后将其恢复到默认状态。这种通过 Webhook 触发自动化的方法可以延伸至其他 IT 操作而无需人工干预，进而实现事件驱动型自动化流程。

唯一的不同之处在于可信来源，Webhook 可以将预期状态引擎连接到第三方工具，以监控特定事件的来源，而非将预期状态引擎连接到依靠人工来推送代码更新的 Git 存储库。一旦这些事件源检测到目标事件并触发 Webhook，有效负载便可以启动自动化，在一天中的任何时间都可以立即执行操作来响应事件，无需 IT 人员执行任何操作。

### Webhook 用于事件驱动型自动化

事件驱动型自动化指的是对 IT 环境中不断变化的条件做出自动响应的过程，目的是加快问题解决速度并减少日常的重复性任务。借助事件驱动型自动化，IT 团队可以对有关任何事件（如硬件问题、分布式拒绝服务（DDoS）攻击、内存不足或应用故障）的响应进行编码，从而在事件发生时自动执行必要的操作。

事件驱动型解决方案依靠第三方工具或插件（如 ServiceNow、Kafka、Prometheus、Sensu、Dynatrace 和 Appdynamics）来监控事件源。Webhook 可用于将这些事件源连接到自动化平台，事件源检测到事件时，Webhook 将触发相应的自动响应。

IT 团队可以逐步采用事件驱动型自动化以缩短平均解决时间（MTTR），还可执行仍然需要人工参与的功能（例如自动创建工单），然后逐步实现全自动修复，以便在出现特定问题时自动执行相应操作。

---

# 什么是 REST API

[原文](https://www.redhat.com/zh/topics/api/what-is-a-rest-api)

EST API 也称为 RESTful API，是遵循 REST 架构规范的应用编程接口（API 或 Web API），支持与 RESTful Web 服务进行交互。REST 是表述性状态传递的英文缩写，由计算机科学家 Roy Fielding 创建。

## 什么是 API？

API 由一组定义和协议组合而成，可用于构建和集成应用软件。有时我们可以把它们当做信息提供者和信息用户之间的合同——建立消费者（呼叫）所需的内容和制作者（响应）要求的内容。例如，天气服务的 API 可指定用户提供邮编，制作者回复的答案由两部分组成，第一部分是最高温度，第二部分是最低温度。

换言之，如果您想与计算机或系统交互以检索信息或执行某项功能，API 可帮助您将您需要的信息传达给该系统，使其能够理解并满足您的请求。

您可以把 API 看做是用户或客户端与他们想要的资源或 Web 服务之间的传递者。它也是企业在共享资源和信息的同时保障安全、控制和身份验证的一种方式，即确定哪些人可以访问什么内容。

API 的另一个优势是您无需了解缓存的具体信息，即如何检索资源或资源来自哪里。

## RESTful 是什么意思？

REST 是一组架构规范，并非协议或标准。API 开发人员可以采用各种方式实施 REST。

当客户端通过 RESTful API 提出请求时，它会将资源状态表述传递给请求者或终端。该信息或表述通过 HTTP 以下列某种格式传输：JSON（Javascript 对象表示法）、HTML、XLT、Python、PHP 或纯文本。JSON 是最常用的编程语言，尽管它的名字英文原意为“JavaScript 对象表示法”，但它适用于各种语言，并且人和机器都能读。

还有一些需要注意的地方：头和参数在 RESTful API HTTP 请求的 HTTP 方法中也很重要，因为其中包含了请求的元数据、授权、统一资源标识符（URI）、缓存、cookie 等重要标识信息。有请求头和响应头，每个头都有自己的 HTTP 连接信息和状态码。

## 如何实现 RESTful API？

API 要被视为 RESTful API，必须遵循以下标准：

- 客户端-服务器架构由客户端、服务器和资源组成，并且通过 HTTP 管理请求。
- 无状态客户端-服务器通信，即 get 请求间隔期间，不会存储任何客户端信息，并且每个请求都是独立的，互不关联。
- 可缓存性数据：可简化客户端-服务器交互。
- 组件间的统一接口：使信息以标准形式传输。这要求：
  - 所请求的资源可识别并与发送给客户端的表述分离开。
  - 客户端可通过接收的表述操作资源，因为表述包含操作所需的充足信息。
  - 返回给客户端的自描述消息包含充足的信息，能够指明客户端应该如何处理所收到的信息。
  - 超文本/超媒体可用，是指在访问资源后，客户端应能够使用超链接查找其当前可采取的所有其他操作。
- 组织各种类型服务器（负责安全性、负载平衡等的服务器）的分层系统会参与将请求的信息检索到对客户端不可见的层次结构中。
- 按需编码（可选）：能够根据请求将可执行代码从服务器发送到客户端，从而扩展客户端功能。

虽然 REST API 需要遵循这些标准，但是仍比遵循规定的协议更容易，如 SOAP（简单对象访问协议），该协议具有 XML 消息传递、内置安全性和事务合规性等具体要求，因此速度较慢、结构繁重。

相比之下，REST 则是一组可按需实施的准则，使 REST API 速度更快、更轻，可扩展性更高，非常适合物联网（IoT）和移动应用开发。

---

# SOAP 和 REST 区别解析

[SOAP 和 REST 区别解析(原文)](https://www.redhat.com/zh/topics/integration/whats-the-difference-between-soap-rest)

REST 和 SOAP 是在线传输数据的两种不同的方法。具体而言，它们都定义了[应用编程接口（API）]()（该接口允许数据在 Web 应用之间交换）的构建方式。表述性状态传递（REST）是一组架构原则。简单对象访问协议（SOAP）则是一个由万维网联盟（W3C）制定的官方协议。二者的主要区别在于 SOAP 是一种协议，而 REST 不是。通常，取决于实际用例和开发人员偏好，API 会遵循 REST 或 SOAP 准则。

## SOAP：简单对象访问协议

SOAP 是一项标准协议，其最初的设计意图是让使用不同语言且在不同平台上构建的应用之间进行通信。由于 SOAP 是一项协议，因此它会施加一些内置规则，从而增加复杂性和开销，并可导致页面加载时间延长。但是，这些标准还提供了内置合规性，使其更适合企业应用。内置合规性标准包括安全性、原子性、一致性、隔离性和持久性（ACID），这是一组旨在确保数据库事务可靠性的属性。

### 常见的 Web 服务规范包括

- Web 服务安全性（WS 安全性）：通过叫做"令牌"的唯一标识符，实现消息安全防护和传输方式的标准化
- WS-ReliableMessaging：标准化了在不可靠的 IT 基础架构间传输消息的错误处理方式
- Web 服务寻址（WS 寻址）：将路由信息打包为 SOAP 标头中的元数据，而不是在网络深处维护此类信息
- Web 服务描述语言（WSDL）：描述 Web 服务的功能以及该服务的工作起点和终点

当有数据请求发送给 SOAP API 时，可以通过任何应用层协议来处理该请求：HTTP（针对 Web 浏览器）、SMTP（针对电子邮件）、TCP 等等。但是，一旦收到请求，返回的 SOAP 消息必须以 XML 文档（一种人机均可读的标记语言）的形式返回。浏览器无法缓存已完成的 SOAP API 请求，因此如果不重新发送给 API，之后便无法访问该请求。

## SOAP 和 REST 的区别是什么？

许多传统系统可能仍会遵循 SOAP 准则，而在基于 Web 的场景中，REST 常常被视为一种后来居上的替代方法。REST 是一组可灵活实施的准则，而 SOAP 则是具有特定要求（例如 XML 消息传递）的协议。

REST API 属于轻量级 API，因此非常适合较新的环境，例如物联网（IoT）、移动应用开发和无服务器计算。SOAP Web 服务可提供符合许多企业需求的内置安全性和事务合规性，但同时也会让它们变得结构繁重。此外，许多公共 API（例如 Google Maps API）都遵循 REST 准则。
